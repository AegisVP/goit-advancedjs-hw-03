{"version":3,"file":"commonHelpers.js","sources":["../src/js/showable.js","../src/js/cat-api.js","../src/main.js"],"sourcesContent":["export class Showable {\n  constructor(element) {\n    this.element = document.querySelector(element);\n  }\n\n  show() {\n    this.element.classList.add('shown');\n  }\n\n  hide() {\n    this.element.classList.remove('shown');\n  }\n}\n","import axios from 'axios';\nimport { Showable } from './showable';\nconst elements = {\n  loading: new Showable('.loader'),\n  error: new Showable('.error'),\n};\n\naxios.defaults.headers.common['x-api-key'] = 'live_pMCfR6LBn2xPtA30XNUDqQuzNboweMfLkokOv7CgweK1nlwealH4JxkyIFM711st';\naxios.defaults.timeout = 1000;\n\nexport const fetchBreeds = () => {\n  elements.loading.show();\n  elements.error.hide();\n  return axios\n    .get('https://api.thecatapi.com/v1/breeds')\n    .then(response => {\n      console.log({ response });\n      return response;\n    })\n    .then(response => response.data.map(({ id, name }) => ({ id, name })))\n    .catch(error => {\n      console.error(error);\n      elements.error.show();\n    })\n    .finally(() => {\n      elements.loading.hide();\n    });\n};\n\nexport const fetchBreed = id => {\n  if (!id) {\n    return null;\n  }\n\n  elements.loading.show();\n  elements.error.hide();\n\n  return axios\n    .get(`https://api.thecatapi.com/v1/images/search?breed_ids=${id}`)\n    .then(response => response.data[0])\n    .then(breedInfo => {\n      const { url, breeds } = breedInfo;\n      const { id, name, description, temperament } = breeds[0];\n      return { id, name, description, temperament, image_url: url };\n    })\n    .catch(error => {\n      console.error(error);\n      elements.error.show();\n      return null;\n    })\n    .finally(() => {\n      elements.loading.hide();\n    });\n};\n","import { fetchBreeds, fetchBreed } from './js/cat-api';\n\nconst elements = {\n  select: document.querySelector('.breed-list'),\n  info: document.querySelector('.breed-info-wrapper'),\n};\n\nconst BREED_LIST_KEY = 'breedList';\nconst BREED_EXPIRY = 3600000 * 24; // 24 hours\n\nconst populateSelect = breedList => {\n  const optionElements = [];\n\n  breedList.forEach(({ id, name }) => {\n    const optionEl = document.createElement('option');\n    optionEl.value = id;\n    optionEl.textContent = name;\n    optionElements.push(optionEl);\n  });\n\n  elements.select.append(...optionElements);\n  elements.select.addEventListener('change', onBreedSelect);\n};\n\nconst onBreedSelect = event => {\n  event.preventDefault();\n  const selectedBreedId = event.target.value;\n\n  if (!selectedBreedId) {\n    elements.info.innerHTML = '';\n\n    return;\n  }\n\n  fetchBreed(selectedBreedId)\n    .then(showBreedInformation)\n    .catch(error => {\n      console.error(error);\n    });\n};\n\nconst showBreedInformation = ({ name, description, temperament, image_url }) => {\n  const catEl = `\n    <div class=\"breed-info\">\n        <img src=\"${image_url}\" width=\"300\" alt=\"${name}\" class=\"thumb\">\n        <div>\n            <h1 class=\"title\">${name}</h1>\n            <p class=\"description\">${description}</p>\n            <p class=\"temperament\">${temperament}</p>\n        </div>\n    </div>`;\n\n  elements.info.innerHTML = catEl;\n};\n\nconst saveLocalBreedList = breedList => {\n  console.log({ breedList, len: breedList?.length });\n  if (!breedList || breedList?.length === 0) return;\n  localStorage.setItem(BREED_LIST_KEY, JSON.stringify({ breedList, expire: Date.now() + BREED_EXPIRY }));\n};\n\nconst getLocalBreedList = () => {\n  const localDataString = localStorage.getItem(BREED_LIST_KEY);\n  if (localDataString) {\n    const localData = JSON.parse(localDataString);\n    if (localData?.expire > Date.now()) {\n      return localData.breedList;\n    }\n  }\n  return;\n};\n\nconst updateBreedList = async () => {\n  let breedList = [];\n  try {\n    breedList = await fetchBreeds();\n    saveLocalBreedList(breedList);\n  } catch (error) {\n    console.error(error);\n  }\n  return breedList;\n};\n\n(async () => {\n  let breedList = getLocalBreedList() || (await updateBreedList());\n\n  populateSelect(breedList);\n})();\n"],"names":["Showable","element","elements","axios","fetchBreeds","response","id","name","error","fetchBreed","breedInfo","url","breeds","description","temperament","BREED_LIST_KEY","BREED_EXPIRY","populateSelect","breedList","optionElements","optionEl","onBreedSelect","event","selectedBreedId","showBreedInformation","image_url","catEl","saveLocalBreedList","getLocalBreedList","localDataString","localData","updateBreedList"],"mappings":"ivBAAO,MAAMA,CAAS,CACpB,YAAYC,EAAS,CACnB,KAAK,QAAU,SAAS,cAAcA,CAAO,CAC9C,CAED,MAAO,CACL,KAAK,QAAQ,UAAU,IAAI,OAAO,CACnC,CAED,MAAO,CACL,KAAK,QAAQ,UAAU,OAAO,OAAO,CACtC,CACH,CCVA,MAAMC,EAAW,CACf,QAAS,IAAIF,EAAS,SAAS,EAC/B,MAAO,IAAIA,EAAS,QAAQ,CAC9B,EAEAG,EAAM,SAAS,QAAQ,OAAO,WAAW,EAAI,wEAC7CA,EAAM,SAAS,QAAU,IAElB,MAAMC,EAAc,KACzBF,EAAS,QAAQ,OACjBA,EAAS,MAAM,OACRC,EACJ,IAAI,qCAAqC,EACzC,KAAKE,IACJ,QAAQ,IAAI,CAAE,SAAAA,CAAQ,CAAE,EACjBA,EACR,EACA,KAAKA,GAAYA,EAAS,KAAK,IAAI,CAAC,CAAE,GAAAC,EAAI,KAAAC,CAAM,KAAM,CAAE,GAAAD,EAAI,KAAAC,CAAI,EAAG,CAAC,EACpE,MAAMC,GAAS,CACd,QAAQ,MAAMA,CAAK,EACnBN,EAAS,MAAM,MACrB,CAAK,EACA,QAAQ,IAAM,CACbA,EAAS,QAAQ,MACvB,CAAK,GAGQO,EAAaH,GACnBA,GAILJ,EAAS,QAAQ,OACjBA,EAAS,MAAM,OAERC,EACJ,IAAI,wDAAwDG,CAAE,EAAE,EAChE,KAAKD,GAAYA,EAAS,KAAK,CAAC,CAAC,EACjC,KAAKK,GAAa,CACjB,KAAM,CAAE,IAAAC,EAAK,OAAAC,CAAQ,EAAGF,EAClB,CAAE,GAAAJ,EAAI,KAAAC,EAAM,YAAAM,EAAa,YAAAC,GAAgBF,EAAO,CAAC,EACvD,MAAO,CAAE,GAAAN,EAAI,KAAAC,EAAM,YAAAM,EAAa,YAAAC,EAAa,UAAWH,EAC9D,CAAK,EACA,MAAMH,IACL,QAAQ,MAAMA,CAAK,EACnBN,EAAS,MAAM,OACR,KACR,EACA,QAAQ,IAAM,CACbA,EAAS,QAAQ,MACvB,CAAK,GArBM,KC7BLA,EAAW,CACf,OAAQ,SAAS,cAAc,aAAa,EAC5C,KAAM,SAAS,cAAc,qBAAqB,CACpD,EAEMa,EAAiB,YACjBC,EAAe,KAAU,GAEzBC,EAAiBC,GAAa,CAClC,MAAMC,EAAiB,CAAA,EAEvBD,EAAU,QAAQ,CAAC,CAAE,GAAAZ,EAAI,KAAAC,CAAI,IAAO,CAClC,MAAMa,EAAW,SAAS,cAAc,QAAQ,EAChDA,EAAS,MAAQd,EACjBc,EAAS,YAAcb,EACvBY,EAAe,KAAKC,CAAQ,CAChC,CAAG,EAEDlB,EAAS,OAAO,OAAO,GAAGiB,CAAc,EACxCjB,EAAS,OAAO,iBAAiB,SAAUmB,CAAa,CAC1D,EAEMA,EAAgBC,GAAS,CAC7BA,EAAM,eAAc,EACpB,MAAMC,EAAkBD,EAAM,OAAO,MAErC,GAAI,CAACC,EAAiB,CACpBrB,EAAS,KAAK,UAAY,GAE1B,MACD,CAEDO,EAAWc,CAAe,EACvB,KAAKC,CAAoB,EACzB,MAAMhB,GAAS,CACd,QAAQ,MAAMA,CAAK,CACzB,CAAK,CACL,EAEMgB,EAAuB,CAAC,CAAE,KAAAjB,EAAM,YAAAM,EAAa,YAAAC,EAAa,UAAAW,CAAS,IAAO,CAC9E,MAAMC,EAAQ;AAAA;AAAA,oBAEID,CAAS,sBAAsBlB,CAAI;AAAA;AAAA,gCAEvBA,CAAI;AAAA,qCACCM,CAAW;AAAA,qCACXC,CAAW;AAAA;AAAA,YAI9CZ,EAAS,KAAK,UAAYwB,CAC5B,EAEMC,EAAqBT,GAAa,CACtC,QAAQ,IAAI,CAAE,UAAAA,EAAW,IAAKA,GAAA,YAAAA,EAAW,MAAM,CAAE,EAC7C,GAACA,IAAaA,GAAA,YAAAA,EAAW,UAAW,IACxC,aAAa,QAAQH,EAAgB,KAAK,UAAU,CAAE,UAAAG,EAAW,OAAQ,KAAK,IAAG,EAAKF,CAAY,CAAE,CAAC,CACvG,EAEMY,EAAoB,IAAM,CAC9B,MAAMC,EAAkB,aAAa,QAAQd,CAAc,EAC3D,GAAIc,EAAiB,CACnB,MAAMC,EAAY,KAAK,MAAMD,CAAe,EAC5C,IAAIC,GAAA,YAAAA,EAAW,QAAS,KAAK,IAAG,EAC9B,OAAOA,EAAU,SAEpB,CAEH,EAEMC,EAAkB,SAAY,CAClC,IAAIb,EAAY,CAAA,EAChB,GAAI,CACFA,EAAY,MAAMd,IAClBuB,EAAmBT,CAAS,CAC7B,OAAQV,EAAO,CACd,QAAQ,MAAMA,CAAK,CACpB,CACD,OAAOU,CACT,GAEC,SAAY,CACX,IAAIA,EAAYU,EAAiB,GAAO,MAAMG,EAAiB,EAE/Dd,EAAeC,CAAS,CAC1B,GAAI"}